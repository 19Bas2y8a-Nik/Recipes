# Диагностика ошибки аутентификации

## Шаг 1: Проверьте конфигурацию через тестовый endpoint

Откройте в браузере:
```
http://localhost:3000/api/test-auth
```

Этот endpoint покажет:
- Какие переменные окружения установлены
- Подключена ли база данных
- Существуют ли необходимые таблицы

## Шаг 2: Проверьте логи сервера

В консоли, где запущен `pnpm dev`, должны быть видны ошибки. Ищите:
- Сообщения об отсутствующих переменных окружения
- Ошибки подключения к базе данных
- Ошибки Prisma

## Шаг 3: Проверьте файл .env.local

Убедитесь, что файл `.env.local` существует в корне проекта и содержит:

```env
DATABASE_URL="postgresql://..."
AUTH_SECRET="ваш-секретный-ключ"
GOOGLE_CLIENT_ID="ваш-client-id"
GOOGLE_CLIENT_SECRET="ваш-client-secret"
```

## Шаг 4: Проверьте подключение к базе данных

Выполните:
```bash
pnpm prisma studio
```

Если Prisma Studio не открывается, проблема в подключении к базе данных.

## Шаг 5: Примените миграции

Если таблицы не существуют:
```bash
pnpm db:push
```

## Шаг 6: Перезапустите сервер

После исправления проблем:
1. Остановите сервер (Ctrl+C)
2. Запустите снова: `pnpm dev`

## Типичные ошибки и решения

### "AUTH_SECRET не установлен"
**Решение:** Создайте файл `.env.local` и добавьте переменную `AUTH_SECRET`

### "Ошибка подключения к базе данных"
**Решение:** 
- Проверьте `DATABASE_URL` в `.env.local`
- Убедитесь, что база данных доступна
- Проверьте правильность строки подключения

### "Таблицы не найдены"
**Решение:** Выполните `pnpm db:push` для создания таблиц

### "Prisma Client не сгенерирован"
**Решение:** Выполните `pnpm prisma generate`
