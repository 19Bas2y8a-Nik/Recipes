# Проверка Google OAuth настроек

## Важно: Проверьте Redirect URI в Google Cloud Console

Конфигурация сервера проверена и работает правильно. Скорее всего проблема в настройке Google OAuth.

### Шаг 1: Проверьте Redirect URI

1. Откройте [Google Cloud Console](https://console.cloud.google.com/)
2. Выберите ваш проект
3. Перейдите в **APIs & Services** → **Credentials**
4. Откройте ваш **OAuth 2.0 Client ID**
5. В разделе **Authorized redirect URIs** проверьте, что добавлен:

   **Для локальной разработки:**
   ```
   http://localhost:3000/api/auth/callback/google
   ```

   **Важно:** 
   - Должен быть `http://` (не `https://`)
   - Должен быть `localhost` (не `127.0.0.1`)
   - Не должно быть слэша в конце
   - Должен быть точный путь `/api/auth/callback/google`

### Шаг 2: Проверьте OAuth Consent Screen

1. В Google Cloud Console перейдите в **APIs & Services** → **OAuth consent screen**
2. Если приложение в режиме "Testing":
   - Добавьте ваш email в раздел **Test users**
   - Или опубликуйте приложение (для production)

### Шаг 3: Проверьте логи

После попытки входа проверьте:
1. **Логи сервера** (консоль, где запущен `pnpm dev`)
2. **Консоль браузера** (F12 → Console)
3. **Network tab** в браузере - посмотрите, какие запросы отправляются

### Шаг 4: Типичные ошибки

#### "redirect_uri_mismatch"
**Причина:** Redirect URI в Google Cloud Console не совпадает с тем, что использует приложение
**Решение:** Добавьте точный URI: `http://localhost:3000/api/auth/callback/google`

#### "access_denied"
**Причина:** Email не добавлен в тестовые пользователи
**Решение:** Добавьте email в OAuth consent screen → Test users

#### "Server error"
**Причина:** Проблема на стороне сервера
**Решение:** 
- Проверьте логи сервера
- Убедитесь, что база данных доступна
- Проверьте переменные окружения

### Шаг 5: После исправления

1. **Подождите 1-2 минуты** после изменений в Google Cloud Console
2. **Очистите кэш браузера** или откройте в режиме инкогнито
3. **Перезапустите сервер разработки** (если нужно)
4. **Попробуйте войти снова**

## Быстрая проверка

Откройте в браузере:
```
http://localhost:3000/api/test-auth
```

Если все переменные установлены и база данных подключена, проблема скорее всего в Google OAuth настройках.
